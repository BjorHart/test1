<?xml version="1.0" encoding="UTF-8" standalone="no"?><Entities build="b2013" majorVersion="8" minorVersion="4" modelPersistenceProviderPackage="H2PersistenceProviderPackage" revision="0" schemaVersion="1040" universal=""><Things><Thing description="Test for MQTT with JSON" documentationContent="" effectiveThingPackage="MQTTThing" enabled="true" homeMashup="" identifier="" lastModifiedDate="2019-08-14T13:37:20.691Z" name="MQTT_Sandvika" projectName="mockup" published="false" tags="Application:InitialVersion;Application:RoboticArm" thingTemplate="MQTT" valueStream="RoboticArm0Data"><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions><Permissions resourceName="*"><PropertyRead><Principal isPermitted="true" name="Administrators" type="Group"/><Principal isPermitted="true" name="SuperUser" type="User"/><Principal isPermitted="true" name="Users" type="Group"/></PropertyRead><PropertyWrite><Principal isPermitted="true" name="Administrators" type="Group"/><Principal isPermitted="true" name="SuperUser" type="User"/><Principal isPermitted="true" name="Users" type="Group"/></PropertyWrite><ServiceInvoke><Principal isPermitted="true" name="Administrators" type="Group"/><Principal isPermitted="true" name="SuperUser" type="User"/><Principal isPermitted="true" name="Users" type="Group"/></ServiceInvoke><EventInvoke><Principal isPermitted="true" name="Administrators" type="Group"/><Principal isPermitted="true" name="SuperUser" type="User"/><Principal isPermitted="true" name="Users" type="Group"/></EventInvoke><EventSubscribe><Principal isPermitted="true" name="Administrators" type="Group"/><Principal isPermitted="true" name="SuperUser" type="User"/><Principal isPermitted="true" name="Users" type="Group"/></EventSubscribe></Permissions></RunTimePermissions><VisibilityPermissions><Visibility><Principal isPermitted="true" name="Everyone" type="Organization"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables><ConfigurationTable description="Automapping Settings" isMultiRow="false" name="Automapping" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="false" baseType="BOOLEAN" description="Enable auto mapping" name="enabled" ordinal="0"/><FieldDefinition aspect.defaultValue="/Thingworx/{s}/{t}/{p}" baseType="STRING" description="Topic format (including {s} (server) {t} (thing) and {p} (property) tokens)" name="format" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><enabled>false</enabled><format><![CDATA[/Thingworx/{s}/{t}/{p}]]></format></Row></Rows></ConfigurationTable><ConfigurationTable description="Connection Settings" isMultiRow="false" name="ConnectionInfo" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="/Thingworx/{s}/{t}" baseType="STRING" description="MQTT client id format (including {s} and {t} tokens)" name="clientIdFormat" ordinal="0"/><FieldDefinition aspect.defaultValue="10000.0" baseType="NUMBER" description="Timeout (milliseconds) to connect" name="connectTimeout" ordinal="0"/><FieldDefinition baseType="PASSWORD" description="MQTT password" name="password" ordinal="0"/><FieldDefinition aspect.defaultValue="0" baseType="INTEGER" description="Desired QoS" name="qos" ordinal="0"/><FieldDefinition aspect.defaultValue="30000.0" baseType="NUMBER" description="Timeout (milliseconds) to retry a connection" name="retryInterval" ordinal="0"/><FieldDefinition baseType="STRING" description="MQTT Server name" name="serverName" ordinal="0"/><FieldDefinition aspect.defaultValue="1883.0" baseType="NUMBER" description="MQTT Server port" name="serverPort" ordinal="0"/><FieldDefinition aspect.defaultValue="5000.0" baseType="NUMBER" description="Timeout (milliseconds) to execute a request" name="timeout" ordinal="0"/><FieldDefinition baseType="STRING" description="MQTT user id" name="userId" ordinal="0"/><FieldDefinition aspect.defaultValue="false" baseType="BOOLEAN" description="Use SSL connection" name="useSSL" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><clientIdFormat><![CDATA[/Thingworx/{s}/{t}]]></clientIdFormat><connectTimeout>10000.0</connectTimeout><password/><qos>0</qos><retryInterval>30000.0</retryInterval><serverName><![CDATA[195.159.164.54]]></serverName><serverPort>1883.0</serverPort><timeout>5000.0</timeout><useSSL>false</useSSL><userId/></Row></Rows></ConfigurationTable><ConfigurationTable description="Property to MQTT topic mappings" isMultiRow="true" name="Mappings" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="Alias name" name="name" ordinal="0"/><FieldDefinition baseType="BOOLEAN" description="Publish changes" name="publish" ordinal="0"/><FieldDefinition baseType="BOOLEAN" description="Subscribe to changes" name="subscribe" ordinal="0"/><FieldDefinition baseType="STRING" description="MQTT Topic ID" name="topic" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><name><![CDATA[JsonData]]></name><publish>false</publish><subscribe>true</subscribe><topic><![CDATA[Data]]></topic></Row></Rows></ConfigurationTable></ConfigurationTables><ThingShape><PropertyDefinitions><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.isPersistent="true" aspect.isReadOnly="true" baseType="JSON" category="" description="" isLocalOnly="false" name="JsonData" ordinal="2"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.defaultValue="59.893158,10.52377,0.0" aspect.isPersistent="true" aspect.isReadOnly="true" baseType="LOCATION" category="" description="" isLocalOnly="false" name="Location" ordinal="8"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.defaultValue="59.893165,11.994036,0.0" baseType="LOCATION" category="" description="" isLocalOnly="false" name="Location2" ordinal="9"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeThreshold="1.0" aspect.dataChangeType="VALUE" aspect.defaultValue="90.0" aspect.isLogged="true" aspect.isPersistent="true" aspect.isReadOnly="false" baseType="NUMBER" category="" description="" isLocalOnly="false" name="lowerAngle" ordinal="3"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeThreshold="1.0" aspect.dataChangeType="VALUE" aspect.defaultValue="90.0" aspect.isLogged="true" aspect.isPersistent="true" aspect.isReadOnly="false" baseType="NUMBER" category="" description="" isLocalOnly="false" name="middleAngle" ordinal="4"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeThreshold="1.0" aspect.dataChangeType="VALUE" aspect.defaultValue="0.0" aspect.isLogged="true" aspect.isPersistent="true" aspect.isReadOnly="false" baseType="NUMBER" category="" description="" isLocalOnly="false" name="rotation" ordinal="7"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" baseType="NUMBER" category="" description="" isLocalOnly="false" name="Runtime" ordinal="10"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="ALWAYS" aspect.isPersistent="false" aspect.isReadOnly="true" baseType="DATETIME" category="" description="" isLocalOnly="false" name="Testdate" ordinal="11"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeThreshold="1.0" aspect.dataChangeType="VALUE" aspect.defaultValue="90.0" aspect.isLogged="true" aspect.isPersistent="true" aspect.isReadOnly="false" baseType="NUMBER" category="" description="" isLocalOnly="false" name="upperAngle" ordinal="5"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeThreshold="1.0" aspect.dataChangeType="VALUE" aspect.defaultValue="0" aspect.isLogged="true" aspect.isPersistent="true" aspect.isReadOnly="false" baseType="LONG" category="" description="" isLocalOnly="false" name="weight" ordinal="6"/></PropertyDefinitions><ServiceDefinitions/><EventDefinitions/><ServiceMappings/><ServiceImplementations/><Subscriptions><Subscription description="" enabled="true" eventName="ThingStart" name="Calculate" source="" sourceProperty="" sourceType="Thing"><ServiceImplementation description="" handlerName="Script" name="Calculate"><ConfigurationTables><ConfigurationTable description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[var today = new Date();
var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
var dateTime = date+' '+time;

// dateDifference(date1:DATETIME, date2:DATETIME):NUMBER
me.Runtime = dateDifference(dateTime,me.lastConnection);




]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation></Subscription><Subscription description="" enabled="true" eventName="DataChange" name="subJson" source="" sourceProperty="JsonData" sourceType="Thing"><ServiceImplementation description="" handlerName="Script" name="subJson"><ConfigurationTables><ConfigurationTable description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[me.lowerAngle = me.JsonData.lower
me.middleAngle = me.JsonData.middle
me.upperAngle = me.JsonData.upper
me.weight = me.JsonData.weight
me.rotation = me.JsonData.rotation]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation></Subscription><Subscription description="" enabled="true" eventName="AnyDataChange" name="Testerdato" source="" sourceProperty="" sourceType="Thing"><ServiceImplementation description="" handlerName="Script" name="Testerdato"><ConfigurationTables><ConfigurationTable description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[var today = new Date();
var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
var dateTime = date+' '+time;
me.Testdate = dateTime;]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation></Subscription></Subscriptions></ThingShape><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations><AlertDefinitions name="JsonData"/><AlertDefinitions name="Location"/><AlertDefinitions name="Location2"/><AlertDefinitions name="lowerAngle"/><AlertDefinitions name="middleAngle"/><AlertDefinitions name="rotation"/><AlertDefinitions name="Runtime"/><AlertDefinitions name="Testdate"/><AlertDefinitions name="upperAngle"/><AlertDefinitions name="weight"/></AlertConfigurations><ImplementedShapes/><ThingProperties><lastConnection><Value>2019-08-14T13:37:20.852Z</Value><Timestamp>2019-08-14T13:37:20.853Z</Timestamp><Quality>GOOD</Quality></lastConnection><rotation><Value>45.0</Value><Timestamp>2019-08-14T13:37:43.902Z</Timestamp><Quality>GOOD</Quality></rotation><weight><Value>0</Value><Timestamp>2019-08-14T13:37:43.902Z</Timestamp><Quality>GOOD</Quality></weight><lowerAngle><Value>5.0</Value><Timestamp>2019-08-14T13:37:43.902Z</Timestamp><Quality>GOOD</Quality></lowerAngle><upperAngle><Value>57.0</Value><Timestamp>2019-08-14T13:37:43.902Z</Timestamp><Quality>GOOD</Quality></upperAngle><middleAngle><Value>48.0</Value><Timestamp>2019-08-14T13:37:43.902Z</Timestamp><Quality>GOOD</Quality></middleAngle><JsonData><Value><json><![CDATA[{"middle":48,"lower":5,"upper":57,"rotation":45,"weight":0}]]></json></Value><Timestamp>2019-08-14T13:37:43.901Z</Timestamp><Quality>GOOD</Quality></JsonData><Location><Value>59.893158,10.52377,0.0</Value><Timestamp>2019-08-14T13:37:20.853Z</Timestamp><Quality>GOOD</Quality></Location></ThingProperties><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="header : name : updated&#10;" timestamp="2019-08-14T13:37:20.691Z" user="Administrator"/></ConfigurationChanges></Thing></Things></Entities>